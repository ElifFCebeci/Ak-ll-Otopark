# Akıllı Otopark
## Projenin Amacı 
Kent merkezlerinde araç yoğunluğunun artmasıyla birlikte, otopark alanlarına duyulan ihtiyaç da önemli ölçüde artmıştır. Bu ihtiyaca yönelik geliştirilen akıllı otopark sistemleri; araç giriş-çıkışlarının, doluluk durumunun ve kullanıcı verilerinin dijital olarak izlenmesini sağlamaktadır. Ancak mevcut sistemler; hatalı sensör verileri, giriş-çıkış verilerinde tutarsızlık, arz-talep dengesizliği ve güvenlik açıkları gibi çeşitli problemler barındırmaktadır. Özellikle sahte veya kopya plaka kullanımı gibi durumlar, sistemin doğruluğunu ve güvenliğini tehdit etmektedir. Bu tür sorunlar, otoparkların verimli kullanımını engellemekte ve kullanıcı deneyimini olumsuz etkilemektedir.

Bu problemi çözebilmek için,birkaç farklı yöntem mevcuttur:
### Sensörler ve Kalman Filtreleme
Akıllı otopark sistemlerinde karşılaşılan en büyük sorunlardan biri, yanıltıcı veya hatalı sensör verileridir. Bu tür hataların önüne geçmek için çeşitli veri doğrulama algoritmaları kullanılabilir. Özellikle, her bir park alanına birden fazla sensör (örneğin, ultrasonik ve manyetik sensör) yerleştirilerek çapraz doğrulama yapılabilir. Sensörlerden gelen verilerin istatistiksel filtreler (örneğin, Kalman Filtresi veya Ortalama Alma yöntemi) ile işlenmesi sayesinde anormal veriler ayıklanabilir. 
### RFID
Araç giriş-çıkışlarında oluşabilecek tutarsızlıkları önlemek için tek bir sisteme bağlı kalmak yerine, birden fazla teknolojinin bir arada kullanılması faydalıdır. Örneğin, RFID(Radio Frequency Identification) veya plaka tanıma sistemlerine ek olarak Lidar, manyetik sensör ve kameraların birlikte kullanılması veri doğruluğunu artırır. Giriş yaptığı halde plaka kaydıyla eşleşmeyen araçlar anomali olarak işaretlenebilir. Veri senkronizasyonu sayesinde, giriş yapıp çıkış kaydı olmayan araçlar belirli bir süre içinde tekrar kontrol edilir ve gerekiyorsa uyarı oluşturulur. Tüm hareketlerin zaman damgası ile kaydedilmesi, veri kayıplarını tespit etmek açısından önemlidir. Ayrıca QR kod veya Bluetooth tabanlı mobil uygulamalarla yapılan kullanıcı doğrulaması, sistemin güvenilirliğini artırır ve sensör verilerine bağımlılığı azaltır.
### Etkin Yönlendirme
Otoparklardaki arz-talep dengesizliği ve yönlendirme eksikliği, park yeri bulma sürecini zorlaştırmaktadır. Bu soruna yönelik olarak, doluluk oranlarını anlık sunan mobil veya web tabanlı sistemler geliştirilebilir. Böylece kullanıcılar, otoparka gitmeden uygun alanı belirleyebilir. Trafik ve doluluk verilerini analiz eden akıllı yönlendirme sistemleri, harita servisleriyle entegre çalışarak en uygun park alanını önerebilir. Ayrıca, rezervasyon sistemleri ile park yerlerinin önceden ayrılması sağlanarak trafik yoğunluğu azaltılabilir ve kaynak kullanımı optimize edilebilir.

## Metodoloji
### 1)Simülasyon 
Bu projede geliştirilen otopark simülasyonunda ,araçların otoparka giriş-çıkış işlemleri ve park yerlerinin doluluk durumu FSM (Finite State Machine) ve DFA (Deterministic Finite Automaton) tabanlı modellerle yönetilmiştir. FSM, araçların park yerine giriş, park etme ve çıkış gibi süreçlerini yönetirken, DFA çıkış işlemini daha belirgin bir şekilde kontrol eder. Otoparkın durumu, her araç hareketi ile güncellenir ve bu güncellemeler, biçimsel dillerdeki dilin sentaksına benzer şekilde bir "geçiş" olarak işlenir. Ayrıca, araçların plaka numarası gibi veriler de sistem tarafından kontrol edilerek, format dışı ya da tekrarlayan plakalar tespit edilir ve anomali bildirilir. Bu süreç, otomata teorisindeki geçişleri ve doğrulama mekanizmalarını yansıtarak, sistemin güvenliğini artırır. MQTT protokolü ise otoparkın durumu hakkında anlık verilerin iletilmesini sağlar. Bu projede kullanılan FSM ve DFA, araçların otoparka giriş-çıkış gibi işlemlerinin ve sistemin genel işleyişinin modellendiği biçimsel araçlardır ve otomata teorisinin temel kavramlarının pratikte nasıl işlediğini açıkça gösterir. Sonuç olarak, bu simülasyon, biçimsel dillerin ve otomata teorisinin gerçek dünyadaki uygulamalarına ışık tutarak, hem teorik bilgiyi hem de pratik beceriyi birleştiren güçlü bir örnek oluşturur.
### 2) MQTT Verilerinin İletimi
Bu projede, otopark sisteminin anlık durumunu takip edebilmek için MQTT (Message Queuing Telemetry Transport) protokolü kullanıldı. Adafruit IO platformu üzerindeki MQTT broker servisi, araçların giriş ve çıkış bilgilerini, otoparkın doluluk durumunu, plaka numaralarını ve sistemdeki olası anomali durumlarını güvenli bir şekilde iletmek için kullanıldı.Bu veriler, düşük bant genişliği ile hızlı bir şekilde Adafruit Cloud’a gönderildi ve Python tabanlı simülasyon ile anlık olarak çekilip görselleştirildi. Böylece, kullanıcılar otoparkın doluluk durumu ve araçlarının durumuyla ilgili gerçek zamanlı bilgi alabiliyor. Ayrıca, plaka doğrulama ve güvenlik ihlalleri de bu sistem üzerinden izlenebiliyor.Bu sayede, otopark yönetimi sürekli olarak güncel bilgilere ulaşabiliyor ve kullanıcılar anında bilgilendirilebiliyor.

### 3) Verilerin Yapay Olarak Üretimi
Gerçek zamanlı otopark simülasyonunun geliştirilmesi sürecinde, sistemin davranışlarını test edebilmek amacıyla veriler yapay olarak üretilmiştir. Simülasyon, farklı senaryoları kapsayacak biçimde tasarlanmıştır. Örneğin, düşük doluluk seviyeleri ve beklenmedik anomali durumları gibi çeşitli durumlar yapay olarak modellenmiştir. Böylece, sistemin hem normal çalışma koşullarında hem de olağan dışı durumlarda nasıl tepki vereceği gözlemlenebilmiştir.
### 4) Mesaj Format Kontrolü
Proje kapsamında MQTT protokolü üzerinden iletilen verilerin anlamlı ve düzenli bir biçimde işlenebilmesi için, mesajların sahip olması gereken yapısal kurallar tasarlanan  XML tabanlı özel bir protokol ile tanımlanmıştır. XML dosyaları aracılığıyla tanımlanan bu yapı sayesinde, her mesajda bulunması gereken alanlar standart bir formatta oluşturulmakta ve sistemin tüm bileşenleri tarafından doğru şekilde yorumlanabilmektedir. Bu yapı, hem veri bütünlüğünü korumakta hem de sistemin genişletilebilirliğine katkı sağlamaktadır. Bu kontroller sayesinde hatalı ya da eksik mesajların iletilmesi engellenerek sistemin güvenilirliği artırılmıştır.Geliştirilen bu özel protokol, MQTT altyapısıyla entegre bir şekilde çalışarak, simülasyon ortamında veri iletiminin güvenli, tutarlı ve yönetilebilir olmasını sağlamaktadır.
### 5) Simülasyon Arayüzü
Gerçek bir otoparktaki hareketliliğin daha iyi görselleştirilmesi ve kullanıcı tarafından park yerlerinin doluluk durumunun daha kolay takip edilebilmesi amacıyla Python dili kullanılarak iki katlı, basit bir otopark simülasyonu geliştirilmiştir. Bu simülasyonda her kat ayrı ayrı görselleştirilmekte; park yerlerinin durumu, gönderilen verilere göre anlık olarak güncellenmektedir. DOLU park yerleri kırmızı, BOŞ park yerleri yeşil renkle gösterilmektedir.
Hatalı veriler ise daha önce gerçekleştirilen XML tabanlı format kontrolü ile fark edilip simülasyon gösteriminden sorumlu feed’lere hiç iletilmemektedir. Böylelikle park yerlerinin dolu ve boş durumları sadece doğruluğu emin olunan veriler ile değişmektedir.
Otoparkın giriş-çıkış bilgileri güncellendikçe her bir katta bulunan boş ve dolu park yeri sayısı da dinamik olarak hesaplanmakta ve kullanıcıya yansıtılmaktadır. Böylece sistem, veri akışı sırasında gerçek zamanlı bir izleme ve analiz ortamı sunmaktadır.
Veri iletimi için Adafruit IO platformunda oluşturulan özel feed'ler kullanılmakta ve bu feed'ler aracılığıyla MQTT protokolü üzerinden veri alışverişi sağlanmaktadır. MQTT ile gönderilen mesajlar, öncelikle sistem içinde tanımlı özel bir protokol ve gramer yapısına göre doğrulanmakta, ardından simülasyona aktarılmaktadır. Bu aşama, veri güvenliği ve tutarlılığı açısından kritik bir adımdır.
Simülasyonda ayrıca, IoT sistemlerinin en temel katmanlarından biri olan haberleşme katmanını canlı gözlemleyebilmek amacıyla ayrı bir pencere tasarlanmıştır. Bu pencerede; gelen mesajın iletildiği zaman damgası, kat numarası, park yeri bilgisi ve veri durumu (DOLU, BOŞ) detaylı olarak listelenmektedir. Bu sayede kullanıcı, haberleşme sürecini anlık olarak takip edebilmekte ve kullanılan protokolleri daha iyi anlamaktadır.
## Sonuç
Biçimsel Diller ve Otomata dersi kapsamında geliştirilen IoT tabanlı Akıllı Otopark Sistemi projesinde, bizler IoT yapısının kritik bir bileşeni olan haberleşme katmanına odaklandık. Projede, IoT teknolojileri kullanılarak katlı bir otoparkta araçların daha verimli şekilde yönlendirilmesi sağlanmış, aynı zamanda sürücülerin boş park yeri ararken harcadığı sürenin azaltılması hedeflenmiştir.
Ancak bu sistemde esas vurgulanan nokta, IoT haberleşmesi sırasında oluşabilecek sorunlara çözüm üretmektir. Bu doğrultuda, çeşitli haberleşme protokolleri incelenmiş ve günümüzde yaygın ve güvenli bir tercih olan MQTT protokolü kullanılmıştır. MQTT protokolü üzerinden, publisher ve subscriber arasında gerçekleşen mesajlaşma süreçleri, mesaj formatları özelinde detaylı olarak ele alınmıştır.
Veri iletiminde yaşanabilecek hatalı iletimlerin sistemde yanıltıcı doluluk veya boşluk bilgisi oluşturmasını engellemek amacıyla iki temel önlem alınmıştır:
1.XML tabanlı bir veri formatı oluşturulmuş ve bu format proje kapsamındaki protokol dili olarak kabul edilmiştir.
2.Gelen veriler, bu formata uygunluk açısından bir parser (ayrıştırıcı) ile denetlenmiş, yalnızca biçimsel kurallara uygun olan verilerin sisteme işlenmesine izin verilmiştir.
Formata uymayan veriler, park yeri bilgilerini manipüle etmemesi için HATALI VERİ olarak işaretlenmiş; bu şekilde sahte dolu/boş durumlarının oluşması engellenmiştir. Bu yaklaşım sayesinde, otoparkta yaşanabilecek olası yönlendirme sorunlarının önüne geçilmiştir.
Bu projede hem günümüzde yaygın kullanılan IoT uygulamaları detaylı şekilde analiz edilmiş, hem de gerçek bir problem üzerinden hareket edilerek haberleşme protokolü doğrulama süreci, Biçimsel Diller bilgisi ile entegre bir yapıda uygulanmıştır. Böylelikle hem teorik altyapı hem de pratik uygulama bir araya getirilmiş, haberleşme katmanının güvenli ve doğru çalışmasını sağlayan bir sistem ortaya konmuştur.

